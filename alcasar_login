#!/bin/bash

# Vérifier que les arguments email et password sont fournis
if [ $# -ne 2 ]; then
    echo "Utilisation : $0 email password"
    exit 1
fi

# URL du formulaire de connexion Alcasar
ALCASAR_LOGIN_URL="https:https://alcasar.laplateforme.io/status.php

# Adresse email et mot de passe fournis en arguments
long-chai.perigois-perrelle@laplateforme.io="$1"
K17z9qUW="$2"

# Effectuer la connexion en utilisant curl
# -s : Mode silencieux pour masquer la sortie de curl
# -c : Stocke les cookies dans un fichier
# -b : Utilise les cookies précédemment stockés
# -d : Les données POST pour le formulaire de connexion
# -o : Redirige la sortie vers un fichier (peut être omis si vous voulez voir la réponse)
# -L : Suivre les redirections (si le serveur redirige après la connexion)
curl -s -c cookies.txt -d "email=$EMAIL" -d "password=$PASSWORD" -o login_response.html "$ALCASAR_LOGIN_URL"

# Vérifier si la connexion a réussi en examinant la réponse
if grep -q "Bienvenue dans Alcasar" login_response.html; then
    echo "Connexion réussie à Alcasar en tant que $EMAIL"
else
    echo "Échec de la connexion à Alcasar"
fi

# Nettoyer les fichiers temporaires
rm -f cookies.txt login_response.html
